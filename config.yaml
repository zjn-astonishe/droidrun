# DroidRun Configuration File for Android World Benchmark
# Local project configuration

_version: 1

# === Agent Settings ===
agent:
  # Agent to use: "droidrun" (native) or external: "mai_ui", "autoglm"
  name: droidrun
  # Maximum number of steps per task
  max_steps: 50
  # Enable planning with reasoning mode (Manager-Executor architecture)
  reasoning: true
  # Enable streaming LLM responses to console in real-time
  streaming: true
  # Sleep duration after each action, waits for ui state to be updated (seconds)
  after_sleep_action: 1.0
  # Wait duration for UI to stabilize (seconds)
  wait_for_stable_ui: 0.3

  # Coordinate system for swipe and state bounds output
  # false = absolute pixels (default)
  # true = normalized [0-1000] range (resolution-independent)
  use_normalized_coordinates: false

  # CodeAct Agent Configuration
  codeact:
    # Enable vision capabilities (screenshots)
    vision: false
    # System prompt path (relative or absolute)
    system_prompt: config/prompts/codeact/system.jinja2
    # User prompt path (relative or absolute)
    user_prompt: config/prompts/codeact/user.jinja2
    # Enable safe code execution (restricts imports and builtins)
    safe_execution: false
    # Execution timeout per code block (seconds)
    execution_timeout: 50.0

  # Manager Agent Configuration
  manager:
    # Enable vision capabilities (screenshots)
    vision: true
    # System prompt path (relative or absolute)
    system_prompt: config/prompts/manager/system.jinja2
    # Use stateless manager (rebuilds context each turn, no chat history, experimental)
    stateless: false

  # Executor Agent Configuration
  executor:
    # Enable vision capabilities (screenshots)
    vision: true
    # System prompt path (relative or absolute)
    system_prompt: config/prompts/executor/system.jinja2

  # Scripter Agent Configuration
  scripter:
    # Enable scripter execution for off-device operations
    enabled: true
    # Maximum steps per scripter agent task
    max_steps: 10
    # Execution timeout per code block (seconds)
    execution_timeout: 30.0
    # System prompt path (relative or absolute)
    system_prompt: config/prompts/scripter/system.jinja2
    # Enable safe code execution (restricts imports and builtins)
    safe_execution: false

  # App Cards Configuration
  app_cards:
    # Enable app-specific instruction cards
    enabled: true
    # Mode: local (file-based), server (HTTP API), or composite (server with local fallback)
    mode: local
    # Directory containing app card files (for local/composite modes)
    app_cards_dir: config/app_cards
    # Server URL for remote app cards (for server/composite modes)
    server_url: null
    # Server request timeout in seconds
    server_timeout: 10.0
    # Number of server retry attempts
    server_max_retries: 2

# === LLM Profiles ===
# Define LLM configurations for each agent type
llm_profiles:
  # Manager: Plans and reasons about task progress
  manager:
    provider: OpenAI
    model: gpt-5
    # provider: OpenAILike
    # model: gemini-2.5-pro
    api_base: https://api.zhizengzeng.com/v1/chat/completions
    base_url: https://api.zhizengzeng.com/v1/chat/completions
    # provider: OpenAILike
    # model: qwen3-vl-8B-instruct
    # api_base: http://localhost:8001/v1
    temperature: 0.2
    kwargs: {}
  executor:
    provider: OpenAI
    model: gpt-5
    # provider: OpenAILike
    # model: gemini-2.5-pro
    api_base: https://api.zhizengzeng.com/v1/chat/completions
    base_url: https://api.zhizengzeng.com/v1/chat/completions
    # provider: OpenAILike
    # model: qwen3-vl-8B-instruct
    # api_base: http://localhost:8001/v1
    temperature: 0.1
    kwargs: {}
  codeact:
    provider: OpenAI
    model: gpt-5
    # provider: OpenAILike
    # model: gemini-2.5-pro
    api_base: https://api.zhizengzeng.com/v1/chat/completions
    base_url: https://api.zhizengzeng.com/v1/chat/completions
    # provider: OpenAILike
    # model: qwen3-vl-8B-instruct
    # api_base: http://localhost:8001/v1
    temperature: 0.2
    kwargs: {}
  text_manipulator:
    # provider: OpenAI
    # model: gpt-4o
    # api_base: https://api.zhizengzeng.com/v1/chat/completions
    # provider: GoogleGenAI
    # model: gemini-2.5-flash
    # base_url: https://api.zhizengzeng.com/v1/chat/completions
    provider: OpenAILike
    model: qwen3-vl-8B-instruct
    api_base: http://localhost:8001/v1
    temperature: 0.3
    kwargs: {}
  app_opener:
    # provider: OpenAI
    # model: gpt-4o
    # api_base: https://api.zhizengzeng.com/v1/chat/completions
    # provider: GoogleGenAI
    # model: gemini-2.5-flash
    # base_url: https://api.zhizengzeng.com/v1/chat/completions
    provider: OpenAILike
    model: qwen3-vl-8B-instruct
    api_base: http://localhost:8001/v1
    temperature: 0.0
    kwargs: {}
  scripter:
    # provider: OpenAI
    # model: gpt-4o-mini
    # api_base: https://api.zhizengzeng.com/v1/chat/completions
    # provider: GoogleGenAI
    # model: gemini-2.5-flash
    # base_url: https://api.zhizengzeng.com/v1/chat/completions
    provider: OpenAILike
    model: qwen3-vl-8B-instruct
    api_base: http://localhost:8001/v1
    temperature: 0.1
    kwargs: {}
  structured_output:
    # provider: OpenAI
    # model: gpt-4o-mini
    # api_base: https://api.zhizengzeng.com/v1/chat/completions
    # provider: GoogleGenAI
    # model: gemini-2.5-flash
    # base_url: https://api.zhizengzeng.com/v1/chat/completions
    provider: OpenAILike
    model: qwen3-vl-8B-instruct
    api_base: http://localhost:8001/v1
    temperature: 0.0
    kwargs: {}
device:
  # Default device serial (null = auto-detect)
  serial: null
  # Use TCP communication instead of usb
  use_tcp: false
  # Platform: android or ios but currently only android is supported
  platform: android

# === Telemetry Settings ===
telemetry:
  # Enable anonymous telemetry
  enabled: true

# === Tracing Settings ===
tracing:
  # Enable tracing
  enabled: false
  # Tracing provider: phoenix or langfuse
  provider: phoenix
  # Upload screenshots to Langfuse (cloud traces)
  langfuse_screenshots: false
  # Langfuse configuration (set as environment variables if not empty string)
  langfuse_secret_key: ""  # LANGFUSE_SECRET_KEY
  langfuse_public_key: ""  # LANGFUSE_PUBLIC_KEY
  langfuse_host: ""        # LANGFUSE_HOST
  langfuse_user_id: "anonymous"  # User ID for tracing
  langfuse_session_id: ""  # Session ID (empty = auto-generate UUID per process)

# === Logging Settings ===
logging:
  # Enable debug logging
  debug: false
  # Trajectory saving level (none, step, action)
  save_trajectory: step
  # Path for trajectory files (absolute or relative to cwd)
  trajectory_path: output/trajectories
  # Trajectory video/gif settings (False, true)
  trajectory_gifs: true
  rich_text: false

# === Safe Execution Settings ===
# Applied when agent.codeact.safe_execution or agent.scripter.safe_execution is true
safe_execution:
  # Allow all imports (ignores allowed_modules, respects blocked_modules)
  allow_all_imports: true

  # Allowed modules (empty + allow_all_imports=false = no imports allowed)
  # Example: ['json', 'requests', 're', 'datetime', 'math', 'collections']
  allowed_modules: []

  # Blocked modules (takes precedence over allowed_modules and allow_all_imports)
  # Prevents dangerous file operations, subprocess execution, and code manipulation
  blocked_modules:
    - os
    - sys
    - subprocess
    - shutil
    - pathlib
    - pty
    - fcntl
    - resource
    - pickle
    - shelve
    - marshal
    - imp
    - importlib
    - ctypes
    - code
    - codeop
    - tempfile
    - glob
    - socket
    - socketserver
    - asyncio

  # Allow all builtins (ignores allowed_builtins, respects blocked_builtins)
  allow_all_builtins: true

  # Allowed builtins (empty + allow_all_builtins=false = use safe defaults)
  # Safe defaults include: int, str, list, dict, print, len, range, etc.
  allowed_builtins: []

  # Blocked builtins (takes precedence over allowed_builtins and allow_all_builtins)
  blocked_builtins:
    - open
    - compile
    - exec
    - eval
    - __import__
    - breakpoint
    - exit
    - quit
    - input

# === Tool Settings ===
tools:
  # Disabled tools - add tool names to disable them
  # Available tools:
  #   - click          # Tap UI elements by index
  #   - click_at       # Tap at specific coordinates
  #   - click_area     # Tap center of an area
  #   - long_press     # Long press UI elements by index
  #   - long_press_at  # Long press at specific coordinates
  #   - type           # Type text into input fields
  #   - system_button  # Press back, home, enter
  #   - swipe          # Swipe gestures
  #   - wait           # Wait for duration
  #   - open_app       # Open apps by name
  #   - type_secret    # Type credentials (requires credentials.enabled: true)
  # Coordinate-based tools disabled by default (enable if needed)
  disabled_tools:
    - click_at
    - click_area
    - long_press_at

# === Credential Settings ===
credentials:
  # Enable credential manager for secure secret storage
  enabled: false
  # Path to credentials file (see config/credentials_example.yaml for format)
  file_path: config/credentials.yaml

# === MCP (Model Context Protocol) Settings ===
# Connect to MCP servers to extend agent capabilities with external tools
# Requires: pip install mcp
mcp:
  # Enable MCP client
  enabled: false

  # MCP server configurations
  # Each server exposes tools that become available to agents
  servers: {}

# === External Agent Settings ===
external_agents:
  # MAI-UI - Alibaba's GUI agent foundation model
  mai_ui:
    llm:
      provider: OpenAILike
      model: Tongyi-MAI/MAI-UI-8B
      api_base: https://enjoyed-placed-theaters-survival.trycloudflare.com/v1
      api_key: EMPTY
      temperature: 0.0
      max_tokens: 2048
      top_p: 1.0
      top_k: -1
    history_n: 3

  # AutoGLM - Open-AutoGLM phone agent
  autoglm:
    llm:
      provider: OpenAILike
      model: autoglm-phone-9b
      api_base: http://localhost:8001/v1
      api_key: qwerasdfzxcv123
      temperature: 0.0
      top_p: 0.85
      frequency_penalty: 0.2
      max_tokens: 3000
    lang: en
    stream: true
